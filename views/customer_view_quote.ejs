<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Bullion Quote - <%= quote.quote_number %></title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            position: relative;
            min-height: 100vh;
            background-color: #000000;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: url('<%= process.env.CUSTOMER_QUOTE_BACKGROUND %>');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            z-index: -3;
        }
        
        /* 20% black filter over entire image */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.2);
            z-index: -2;
        }
        
        /* Black gradient overlay fading from left to right */
        .bg-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to right, 
                rgba(0, 0, 0, 1) 0%, 
                rgba(0, 0, 0, 0.9) 20%,
                rgba(0, 0, 0, 0.7) 30%,
                rgba(0, 0, 0, 0.3) 40%, 
                rgba(0, 0, 0, 0) 50%);
            z-index: -1;
        }
        .company-logo {
            max-height: 80px;
        }
        @media (max-width: 576px) {
            .company-logo {
                max-height: 50px;
            }
        }

        /* Professional List with SVG bullets */
        .professional-list {
            list-style-type: none;
            padding-left: 0;
        }

        .professional-list li {
            padding-left: 3rem;
            position: relative;
            margin-bottom: 2rem;
        }

        .professional-list li::before {
            content: '';
            display: inline-block;
            width: 2rem;
            height: 2rem;
            background-size: contain;
            background-repeat: no-repeat;
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
        }

        .professional-list .item-professional::before {
            background-image: url('/svg/professional.svg');
        }

        .professional-list .item-private::before {
            background-image: url('/svg/private.svg');
        }

        .professional-list .item-local::before {
            background-image: url('/svg/local.svg');
        }
    </style>
</head>
<body>
    <div class="bg-overlay"></div>
    <div class="container mt-4">
        <div class="mb-4">
            <a href="https://www.christchurchgold.co.nz" target="_blank" rel="noopener noreferrer">
                <img src="<%= process.env.COMPANY_LOGO_URL_WHITE %>" alt="<%= process.env.COMPANY_NAME %> Logo" class="company-logo">
            </a>
        </div>
        <div class="card">
            <div class="card-header">
                <h1 class="text-start mb-0">Bullion Quote: <%= quote.quote_number %></h1>
            </div>
            <div class="card-body">
                <div class="border rounded p-3 mb-4">
                     <blockquote class="mb-4" style="font-size: 1.2em; font-weight: bold; font-style: italic; border-left: 5px solid #ccc; padding-left: 15px; color: #555;">
                            Sell Your Gold & Silver easily, quickly and at a great rate.
                        </blockquote>
                    
                    <p class="mb-0">Cash & Bank transfer options, secure premises in Hornby or free post from anywhere in NZ.</p>
                </div>
                
                <div class="card mb-4" style="margin-top: 40px">
                    <div class="card-header">
                        <h2>Market Price</h2>
                    </div>
                    <div class="card-body">
                        <p class="mb-4">All prices are based on the current market spot price and continue to update. Quoted rates remain fixed however on the day of selling, the total value will change due to market activity. To secure this price, we suggest trading ASAP and making contact early.</p>
                        <div class="row">
                            <div class="col-6">
                                <p class="mb-2">1 Troy Oz Gold:</p>
                                <p class="mb-2">1 Troy Oz Silver:</p>
                                <p class="mb-2">1 gram Gold:</p>
                                <p class="mb-2">1 gram Silver:</p>
                            </div>
                            <div class="col-6">
                                <p class="mb-2">$<%= Number(quote.spot_price_gold_ounce_nzd).toFixed(2) %> NZD</p>
                                <p class="mb-2">$<%= Number(quote.spot_price_silver_ounce_nzd).toFixed(2) %> NZD</p>
                                <p class="mb-2">$<%= Number(quote.spot_price_gold_gram_nzd).toFixed(2) %> NZD</p>
                                <p class="mb-2">$<%= Number(quote.spot_price_silver_gram_nzd).toFixed(2) %> NZD</p>
                            </div>
                        </div>
                        <p class="mt-2"><i>Source: <%= new Date(quote.updated_at).toLocaleString() %>: <a href="https://www.ice.com/iba/lbma-gold-silver-price" target="_blank" rel="noopener noreferrer">(LBMA)</a></i></p>
                    </div>
                </div>

                <div class="card mb-4" style="margin-top: 40px">
                    <div class="card-header">
                        <h3>Quoted Rate</h3>
                    </div>
                    <div class="card-body">
                        <p>This rate is tied to the quote number: <%= quote.quote_number %>. Your personal details have not be attached to this record so please refer to this number when speaking with a dealer.</p>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Item Name</th>
                                    <th>Metal Type</th>
                                    <th>Qty</th>
                                    <th>Weight</th>
                                    <th>Quoted Rate</th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% 
                                const weightTypeMap = {
                                    "1": "1g",
                                    "5": "5g",
                                    "10": "10g",
                                    "20": "20g",
                                    "50": "50g",
                                    "1.555175": "1/20 oz",
                                    "3.11035": "1/10 oz",
                                    "15.55175": "1/2 oz",
                                    "31.1035": "1 oz",
                                    "62.207": "2 oz",
                                    "155.5175": "5 oz",
                                    "311.035": "10 oz",
                                    "1000": "1 Kgs"
                                };

                                let grandTotal = 0;
                                items.forEach(item => { 
                                    // Calculate row total based on metal type, weight, and percent
                                    const weight = Number(item.weight);
                                    const percent = Number(item.percent) || 0;
                                    const quantity = item.quantity || 1;
                                    
                                    let basePricePerGram = 0;
                                    if (item.metal_type === 'Gold') {
                                        basePricePerGram = Number(quote.spot_price_gold_gram_nzd);
                                    } else if (item.metal_type === 'Silver') {
                                        basePricePerGram = Number(quote.spot_price_silver_gram_nzd);
                                    }

                                    const rowTotal = (weight * basePricePerGram) * quantity * (1 - (percent / 100));
                                    
                                    grandTotal += rowTotal;
                                %>
                                    <tr>
                                        <td><%= item.item_name %></td>
                                        <td><%= item.metal_type %></td>
                                        <td><%= quantity %></td>
                                        <td><%= weightTypeMap[item.weight_type] || item.weight + ' g' %></td>
                                        <td><%= percent %>%</td>
                                        <td>$<%= rowTotal.toFixed(2) %></td>
                                    </tr>
                                <% }); %>
                                <tr class="fw-bold" style="border-top: 1px solid #dee2e6;">
                                    <td colspan="5" class="text-end" style="padding-top: 40px;">Grand Total:</td>
                                    <td style="padding-top: 40px;">$<%= grandTotal.toFixed(2) %></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
            </div>
        </div>
        
        <div class="card" style="margin-top: 60px; margin-bottom: 60px;">
            <div class="card-header">
                <h1 class="text-start mb-0">Options:</h1>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4 text-start mb-4">
                        <svg width="40" height="40" viewBox="0 0 40 40" class="mb-3">
                            <circle cx="20" cy="20" r="18" fill="#0d6efd" stroke="#0d6efd" stroke-width="2"/>
                            <text x="20" y="27" text-anchor="middle" fill="white" font-size="20" font-weight="bold">1</text>
                        </svg>
                        <p class="mb-3"><strong>Make a time to trade face to face or discuss any questions.</strong> Our premises is convenient, light, friendly and secure. You will be our only client. Cash and bank transfer are available on the day.</p>
                        <a href="https://christchurchgold.webflow.io/contact-us" target="_blank" rel="noopener noreferrer" class="btn" style="background-color: #ced4da; color: #000;">Book Time</a>
                    </div>
                    <div class="col-md-4 text-start mb-4">
                        <svg width="40" height="40" viewBox="0 0 40 40" class="mb-3">
                            <circle cx="20" cy="20" r="18" fill="#0d6efd" stroke="#0d6efd" stroke-width="2"/>
                            <text x="20" y="27" text-anchor="middle" fill="white" font-size="20" font-weight="bold">2</text>
                        </svg>
                        <p class="mb-3"><strong>Post it.</strong> We will send you a secure, free, insured courier package. Note: limited to $20,000 in value.</p>
                        <a href="https://christchurchgold.webflow.io/sell-gold" target="_blank" rel="noopener noreferrer" class="btn" style="background-color: #ced4da; color: #000;">Post It</a>
                    </div>
                    <div class="col-md-4 text-start mb-4">
                        <svg width="40" height="40" viewBox="0 0 40 40" class="mb-3">
                            <circle cx="20" cy="20" r="18" fill="#0d6efd" stroke="#0d6efd" stroke-width="2"/>
                            <text x="20" y="27" text-anchor="middle" fill="white" font-size="20" font-weight="bold">3</text>
                        </svg>
                        <p class="mb-3"><strong>Mobility constraints?</strong> We are happy to work with clients to find a solution that fits.</p>
                        <a href="tel:0392257715">(03) 925 7715</a>
                    </div>
                </div>
                
                <hr class="my-4">
                
                <h5 class="mb-3">Contact Us</h5>
                <p class="mb-2"><strong>Phone:</strong> <a href="tel:039257715">(03) 925 7715</a></p>
                <p class="mb-2"><strong>Mobile:</strong> <a href="tel:0212451178">021 245 1178</a></p>
                <p class="mb-2"><strong>Private Telegram:</strong> <a href="https://t.me/m/UeYxKnaqYzMx" target="_blank" rel="noopener noreferrer">link</a></p>
                <p class="mb-2"><strong>Email:</strong> <a href="mailto:sales@christchurchgold.co.nz">sales@christchurchgold.co.nz</a></p>
                <p class="mb-0"><strong>Book Appt:</strong> <a href="https://www.christchurchgold.co.nz/contact-us" target="_blank" rel="noopener noreferrer">link</a></p>
            </div>
        </div>
        
        <div class="card" style="margin-top: 60px; margin-bottom: 60px;">
            <div class="card-header">
                <h1 class="text-start mb-0">Need to Know:</h1>
            </div>
            <div class="card-body">
                <div class="card mb-4" style="margin-top: 20px">
                    <div class="card-header d-flex align-items-center">
                        <h2 class="mb-0">Why Chch Gold?</h2>
                        <!-- <img src="<%= process.env.COMPANY_LOGO_URL %>" alt="<%= process.env.COMPANY_NAME %> Logo" style="width: 12%; margin-left: 20px;"> -->
                    </div>
                    <div class="card-body">
                        <ul class="professional-list" >
                            <li class="item-professional" style="margin-top: 20px">Easy, professional with great pricing.</li>
                            <li class="item-private">We value your privacy. Paper only records used when possible or SHA-256 encrypted data & deletion of non-mandatory records after 14 days.</li>
                            <li class="item-local">Christchurch location, established reputation with international trading partners.</li>
                        </ul>
                    </div>
                </div>

                <div class="card mb-4" style="margin-top: 40px">
                    <div class="card-header">
                        <h2>Location</h2>
                    </div>
                    <div class="card-body">
                        <img src="https://cdn.prod.website-files.com/676bc93dc0d75728455c893b/67baa9b8300720200e378cb4_office_space.jpg" alt="Office Space" class="img-fluid rounded" style="width: 40%;">
                    </div>
                        <div class="card-body">
                        <blockquote class="mb-4" style="font-size: 1.2em; font-weight: bold; font-style: italic; border-left: 5px solid #ccc; padding-left: 15px; color: #555;">
                            Secure, friendly, light trading premises by appointment
                        </blockquote>
                        <a href="https://christchurchgold.webflow.io/contact-us" target="_blank" rel="noopener noreferrer" class="btn" style="background-color: #ced4da; color: #000; margin-top: 20px;">Book a Time</a>
                    </div>
                </div>
                <div class="card mb-4" style="margin-top: 40px">
                    <div class="card-header">
                        <h2>Payment Terms</h2>
                    </div>
                    <div class="card-body">
                        <ul class="mb-0" style="line-height: 2;">
                            <li>All payments are made via direct bank transfer to your nominated New Zealand bank account.</li>
                            <li>Payments are typically processed within 2-24 hours of agreement.</li>
                            <li>Cash payments are avaialabe however limited to $10,000 per person per day.</li>
                        </ul>
                    </div>
                </div>
                <div class="card mb-4" style="margin-top: 40px">
                    <div class="card-header">
                        <h2>Key Condishions</h2>
                    </div>
                    <div class="card-body">
                        <p class="mb-0">Placeholder text for the fourth new section.</p>
                    </div>
                </div>
                <div class="card mb-4" style="margin-top: 40px">
                    <div class="card-header">
                        <h2>Our Buying Process</h2>
                    </div>
                    <div class="card-body">
                        <p class="mb-3">Christchurch Gold buys precious metals, regardless of where they were purchased.</p>
                        <p class="mb-3">Here is the process, which we aim to make as simple as possible:</p>
                        <p class="mb-2">Simply call or email us with details of what you would like to sell.</p>
                        <p class="mb-2">We'll give you a price indication of what Christchurch Gold can offer, either as a percentage below spot or as a NZD value.</p>
                        <p class="mb-2">You may wish to obtain another quote elsewhere – always come back to us before you make your final decision to sell.</p>
                        <p class="mb-2">If you decide to go ahead, we'll need to see the coins or bars. You can either make an appointment to come into our office personally or we will send a courier bag so you can return the metal, at our cost, fully insured.</p>
                        <p class="mb-2">Once we physically check the coins or bars for purity, we will give you a firm price based on the spot price at that moment. This will be the contract price if you agree to sell.</p>
                        <p class="mb-0">Payment will be made to your nominated bank account within 2-24 hours.</p>
                    </div>
                </div>

                <div class="card mb-4" style="margin-top: 40px">
                    <div class="card-header">
                        <h2>What We Buy</h2>
                    </div>
                    <div class="card-body">
                        <p class="mb-0">We purchase gold and silver bullion coins, bars, and rounds from any reputable mint or refinery. Items must be in good condition with verifiable purity.</p>
                    </div>
                </div>

                
            </div>
        </div>
    </div>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
