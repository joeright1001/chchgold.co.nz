<!-- Date Created & Status Panel -->
<div class="card mb-4">
    <div class="card-header">
        <h2>Date Created & Status</h2>
    </div>
    <div class="card-body">
        <p><strong>Status:</strong> <span class="badge bg-<%= quote.status === 'active' ? 'success' : 'danger' %>"><%= quote.status %></span></p>
        <p><strong>Date Created:</strong> <%= new Date(quote.created_at).toLocaleString() %></p>
        <% if (quote.status === 'active') { %>
            <form id="expire-form" action="/admin/<%= quote.id %>/expire" method="POST">
                <button type="submit" class="btn btn-warning">
                    <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                    Mark as Expired
                </button>
            </form>
        <% } %>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // Handle expire form submission spinner
    const expireForm = document.getElementById('expire-form');
    if (expireForm) {
        const expireButton = expireForm.querySelector('button[type="submit"]');
        const expireSpinner = expireButton.querySelector('.spinner-border');

        expireForm.addEventListener('submit', (event) => {
            // Show confirmation dialog
            const isConfirmed = confirm('Are you sure you want to mark this quote as expired?');
            
            if (!isConfirmed) {
                event.preventDefault(); // Stop form submission if user cancels
                return;
            }

            // Prevent multiple submissions
            if (expireButton.disabled) {
                event.preventDefault();
                return;
            }

            // Show spinner and disable button
            expireSpinner.classList.remove('d-none');
            expireButton.disabled = true;
        });
    }
});
</script>
